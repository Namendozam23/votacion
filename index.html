<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elecciones Primarias</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #a9eefc;
        }
        .container {
            margin-top: 50px;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            background-color: #ffc107; /* Bootstrap yellow */
            color: #343a40; /* Dark text for contrast */
            padding: 15px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 30px;
            font-weight: bold;
        }
        .section-title {
            margin-top: 30px;
            margin-bottom: 20px;
            color: #007bff; /* Bootstrap primary blue */
        }
        .form-label {
            font-weight: bold;
        }
        .candidate-card {
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #fefefe;
        }
        .candidate-card input[type="radio"] {
            margin-right: 10px;
        }
        #votingTableInfo {
            font-size: 1.1em;
            font-weight: bold;
            color: #28a745; /* Bootstrap green */
            margin-top: 20px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ELECCIONES PRIMARIAS</h1>
        </div>

        <h2 class="section-title">CREAR CUENTA</h2>
        <form id="createAccountForm" class="row g-3">
            <div class="col-md-6">
                <label for="ci" class="form-label">CI</label>
                <input type="text" class="form-control" id="ci" required>
            </div>
            <div class="col-md-6">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre" required>
            </div>
            <div class="col-md-6">
                <label for="apellido" class="form-label">Apellido</label>
                <input type="text" class="form-control" id="apellido" required>
            </div>
            <div class="col-md-6">
                <label for="correo" class="form-label">Correo</label>
                <input type="email" class="form-control" id="correo" required>
            </div>
            <div class="col-md-6">
                <label for="telf" class="form-label">Teléfono</label>
                <input type="tel" class="form-control" id="telf">
            </div>
            <div class="col-md-6">
                <label for="departamento" class="form-label">Departamento</label>
                <select id="departamento" class="form-select" required>
                    <option value="">Seleccione...</option>
                    <option value="La Paz">La Paz</option>
                    <option value="Santa Cruz">Santa Cruz</option>
                    <option value="Cochabamba">Cochabamba</option>
                    <option value="Oruro">Oruro</option>
                    <option value="Potosi">Potosí</option>
                    <option value="Tarija">Tarija</option>
                    <option value="Chuquisaca">Chuquisaca</option>
                    <option value="Beni">Beni</option>
                    <option value="Pando">Pando</option>
                </select>
            </div>
            <div class="col-md-6">
                <label for="fechaNacimiento" class="form-label">Fecha de Nacimiento</label>
                <input type="date" class="form-control" id="fechaNacimiento" required>
            </div>
            <div class="col-md-6">
                <label for="fechaVotacion" class="form-label">Fecha de Votación</label>
                <input type="date" class="form-control" id="fechaVotacion" required>
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-primary">Registrar Cuenta</button>
            </div>
        </form>

        <h2 class="section-title">LOGIN</h2>
        <form id="loginForm" class="row g-3">
            <div class="col-md-6">
                <label for="loginCi" class="form-label">CI</label>
                <input type="text" class="form-control" id="loginCi" required>
            </div>
            <div class="col-md-6">
                <label for="loginPassword" class="form-label">Contraseña (Usar CI para simular)</label>
                <input type="password" class="form-control" id="loginPassword" required>
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-success">Iniciar Sesión</button>
                <button type="button" class="btn btn-link" id="forgotPasswordBtn">Olvidé Contraseña</button>
            </div>
        </form>

        <h2 class="section-title">VER MESA DE VOTACIÓN</h2>
        <button type="button" class="btn btn-info" id="viewVotingTableBtn">Ver en qué Mesa me Toca Votar</button>
        <p id="votingTableInfo" class="mt-3 hidden"></p>

        <h2 class="section-title">VOTAR</h2>
        <div id="votingSection" class="hidden">
            <p>Seleccione un candidato:</p>
            <div class="mb-10">
                <div class="candidate-card">
                    <input type="radio" id="candidate1" name="candidate" value="Candidato A">
                    <label for="candidate1">JUAN PEREZ</label>
                </div>
                <div class="candidate-card">
                    <input type="radio" id="candidate2" name="candidate" value="Candidato B">
                    <label for="candidate2">ISABEL MENDEZ</label>
                </div>
                <div class="candidate-card">
                    <input type="radio" id="candidate3" name="candidate" value="Candidato C">
                    <label for="candidate3">ADONIS HUANCA</label>
                </div>
                <div class="candidate-card">
                    <input type="radio" id="candidate4" name="candidate" value="candidate D">
                    <label for="candidate4">JIMMY CAPQUIQUE</label>
                </div>
            </div>
            <button type="button" class="btn btn-primary" id="voteBtn">VOTAR</button>
        </div>

        <h2 class="section-title">ESTADÍSTICAS</h2>
        <div id="statisticsSection">
            <p>Votos por Candidato:</p>
            <ul>
                <li id="statsCandidate1">Candidato A: 0</li>
                <li id="statsCandidate2">Candidato B: 0</li>
                <li id="statsCandidate3">Candidato C: 0</li>
            </ul>
            <p>Total de Votantes Registrados: <span id="registeredVotersCount">0</span></p>
            <p>Votantes que ya votaron: <span id="votedVotersCount">0</span></p>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Array to store voter data (simulating a "vector" of 10 voters)
        // In a real application, this would be stored server-side or in a database.
        let voters = [];
        const MAX_VOTERS = 10;
        let loggedInUserCI = null; // To keep track of the logged-in user

        // Vote counts for statistics
        let votes = {
            "Candidato A": 0,
            "Candidato B": 0,
            "Candidato C": 0
        };

        // --- Functions ---

        function updateStatistics() {
            document.getElementById('statsCandidate1').textContent = `Candidato A: ${votes["Candidato A"]}`;
            document.getElementById('statsCandidate2').textContent = `Candidato B: ${votes["Candidato B"]}`;
            document.getElementById('statsCandidate3').textContent = `Candidato C: ${votes["Candidato C"]}`;
            document.getElementById('registeredVotersCount').textContent = voters.length;
            document.getElementById('votedVotersCount').textContent = voters.filter(v => v.hasVoted).length;
        }

        // --- Event Listeners ---

        document.getElementById('createAccountForm').addEventListener('submit', function(event) {
            event.preventDefault();

            if (voters.length >= MAX_VOTERS) {
                alert('Se ha alcanzado el límite de 10 votantes. No se pueden registrar más cuentas.');
                return;
            }

            const ci = document.getElementById('ci').value;
            const nombre = document.getElementById('nombre').value;
            const apellido = document.getElementById('apellido').value;
            const correo = document.getElementById('correo').value;
            const telf = document.getElementById('telf').value;
            const departamento = document.getElementById('departamento').value;
            const fechaNacimiento = document.getElementById('fechaNacimiento').value;
            const fechaVotacion = document.getElementById('fechaVotacion').value;

            // Check if CI already exists
            const ciExists = voters.some(voter => voter.ci === ci);
            if (ciExists) {
                alert('ERROR: El CI ingresado ya está registrado.');
                return;
            }

            // Assign a random voting table (mesa) for simplicity
            const votingTable = Math.floor(Math.random() * 10) + 1; // Random number between 1 and 10

            const newVoter = {
                ci,
                nombre,
                apellido,
                correo,
                telf,
                departamento,
                fechaNacimiento,
                fechaVotacion,
                votingTable: votingTable,
                hasVoted: false // New property to track if the voter has voted
            };

            voters.push(newVoter);
            alert('Cuenta creada exitosamente para ' + nombre + ' ' + apellido + '! Su CI es: ' + ci);
            document.getElementById('createAccountForm').reset(); // Clear the form
            updateStatistics();
            console.log("Voters array:", voters); // For debugging
        });

        document.getElementById('loginForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const loginCi = document.getElementById('loginCi').value;
            const loginPassword = document.getElementById('loginPassword').value;

            // In this simulation, the CI is used as the password
            const foundVoter = voters.find(voter => voter.ci === loginCi && voter.ci === loginPassword);

            if (foundVoter) {
                alert('Inicio de sesión exitoso como ' + foundVoter.nombre + '!');
                loggedInUserCI = foundVoter.ci;
                // Show voting section if not already voted
                if (!foundVoter.hasVoted) {
                    document.getElementById('votingSection').classList.remove('hidden');
                } else {
                    alert('Usted ya ha votado.');
                    document.getElementById('votingSection').classList.add('hidden');
                }
            } else {
                alert('CI o Contraseña incorrectos.');
                loggedInUserCI = null;
                document.getElementById('votingSection').classList.add('hidden');
            }
        });

        document.getElementById('forgotPasswordBtn').addEventListener('click', function() {
            alert('Para esta simulación, su contraseña es su número de CI.');
        });

        document.getElementById('voteBtn').addEventListener('click', function() {
            if (!loggedInUserCI) {
                alert('Debe iniciar sesión para votar.');
                return;
            }

            const selectedCandidate = document.querySelector('input[name="candidate"]:checked');

            if (selectedCandidate) {
                const voterIndex = voters.findIndex(voter => voter.ci === loggedInUserCI);
                if (voterIndex !== -1 && !voters[voterIndex].hasVoted) {
                    votes[selectedCandidate.value]++;
                    voters[voterIndex].hasVoted = true; // Mark voter as having voted
                    alert('¡Voto registrado para ' + selectedCandidate.value + '!');
                    updateStatistics();
                    document.getElementById('votingSection').classList.add('hidden'); // Hide voting section after voting
                } else if (voterIndex !== -1 && voters[voterIndex].hasVoted) {
                    alert('Usted ya ha votado. No puede votar de nuevo.');
                }
            } else {
                alert('Por favor, seleccione un candidato.');
            }
        });

        document.getElementById('viewVotingTableBtn').addEventListener('click', function() {
            if (!loggedInUserCI) {
                alert('Por favor, inicie sesión para ver su mesa de votación.');
                return;
            }

            const foundVoter = voters.find(voter => voter.ci === loggedInUserCI);
            const votingTableInfo = document.getElementById('votingTableInfo');

            if (foundVoter) {
                votingTableInfo.textContent = `¡Hola ${foundVoter.nombre}! Le toca votar en la Mesa N° ${foundVoter.votingTable} del departamento de ${foundVoter.departamento}.`;
                votingTableInfo.classList.remove('hidden');
            } else {
                votingTableInfo.textContent = 'No se encontró su información de mesa de votación. ¿Está registrado?';
                votingTableInfo.classList.remove('hidden');
            }
        });

        // Initial statistics update
        updateStatistics();

    </script>
</body>
</html>